* Global functions and key bindings

** Custom Functions
#+BEGIN_SRC emacs-lisp
  (defun me/comment-or-uncomment-region-or-line ()
    "Comments or uncomments the region or the current line if there's no active region."
    (interactive)
    (let (beg end)
      (if (region-active-p)
          (setq beg (region-beginning) end (region-end))
        (setq beg (line-beginning-position) end (line-end-position)))
      (comment-or-uncomment-region beg end)
      (next-line)))
  (define-key prog-mode-map (kbd "C-;") 'me/comment-or-uncomment-region-or-line)

  (defun me/switch-to-previous-buffer ()
    (interactive)
    (switch-to-buffer (other-buffer (current-buffer) 1)))
  (global-set-key (kbd "<C-tab>") 'me/switch-to-previous-buffer)

  (defun me/kill-region-or-backward-kill-word (&optional arg region)
    "`kill-region' if the region is active, otherwise `backward-kill-word'"
    (interactive
     (list (prefix-numeric-value current-prefix-arg) (use-region-p)))
    (if region
        (kill-region (region-beginning) (region-end))
      (backward-kill-word arg)))
  (global-set-key (kbd "C-w") 'me/kill-region-or-backward-kill-word)

  (defun me/my-put-file-name-on-clipboard ()
    "Put the current file name on the clipboard"
    (interactive)
    (let ((filename (if (equal major-mode 'dired-mode)
                        default-directory
                      (buffer-file-name))))
      (when filename
        (with-temp-buffer
          (insert filename)
          (clipboard-kill-region (point-min) (point-max)))
        (message filename))))
  (global-set-key (kbd "C-x M-w") 'me/my-put-file-name-on-clipboard)

  (defun me/duplicate-line ()
    "Duplicate current line."
    (interactive)
    (move-beginning-of-line 1)
    (kill-line)
    (yank)
    (open-line 1)
    (next-line 1)
    (yank))

  (global-set-key (kbd "C-M-y") 'me/duplicate-line)

  (defun me/dired-open-this-dir ()
    "Open Dired here."
    (dired (expand-file-name ".")))
  (global-set-key (kbd "C-x C-d") 'me/dired-open-this-dir)

  (defun me/kill-till-end ()
    "Deletes everything from point to end of file"
    (interactive)
    (delete-region
     (point)
     (point-max)))
  (global-set-key (kbd "C-x C-k DEL") 'me/kill-till-end)
#+END_SRC
** Cutupm KBD Macro
Removed all macroses to functions ATM; decided to leave =defkbdmacro= here for
future refrence.
#+BEGIN_SRC emacs-lisp
  (defmacro defkbdmacro (name keyseq-string &optional docstring)
    `(fset (quote ,name)
           (lambda (&optional arg)
             ,docstring
             (interactive "p")
             (kmacro-exec-ring-item (quote (,keyseq-string 0 "%d")) arg))))
#+END_SRC
** Global vars, hooks and key bindings
#+BEGIN_SRC emacs-lisp
  (use-package emacs
    :hook (before-save . delete-trailing-whitespace)

    :init
    (show-paren-mode 1)

    :config
    (put 'narrow-to-region 'disabled nil)
    (put 'narrow-to-page 'disabled nil)
    (put 'downcase-region 'disabled nil)
    (setq-default indent-tabs-mode nil
                  word-wrap nil
                  truncate-lines t)
    (setq x-select-enable-clipboard t
          x-select-enable-primary t
          browse-url-browser-function 'browse-url-chrome
          uniquify-buffer-name-style 'forward
          save-interprogram-paste-before-kill t
          apropos-do-all t
          mouse-yank-at-point t
          save-place-file (concat user-emacs-directory ".places")
          backup-directory-alist `(("." . ,(concat user-emacs-directory ".backups"))))

    (define-key key-translation-map (kbd "C-h") (kbd "<DEL>"))

    :bind (("M-[" . other-window)
           ([remap text-scale-decrease] . undo)
           ("C--" . undo)
           ("<C-return>" . save-buffer)
           ("C-x RET RET" . compile)
           ("C-M-;" . replace-regexp)
           ("C-x H" . help)
           ("C-c M-." . insdate-insert-current-date)
           ("C-x C-g" . goto-address-at-point)
           ("M-/" . hippie-expand)
           ("C-s" . isearch-forward-regexp)
           ("C-r" . isearch-backward-regexp)
           ("s-k" . windmove-up)
           ("s-j" . windmove-down)
           ("s-h" . windmove-left)
           ("s-l" . windmove-right)))
#+END_SRC
* Appearance
** Disable all GUI
#+BEGIN_SRC emacs-lisp
(menu-bar-mode 0)
(scroll-bar-mode 0)
(tool-bar-mode 0)
(tooltip-mode 0)
(global-hl-line-mode 1)

(blink-cursor-mode 1)
(setq ring-bell-function 'ignore)
(setq-default indicate-buffer-boundaries 'left)
(use-package diminish)
#+END_SRC
** Color Theme
#+BEGIN_SRC emacs-lisp
  (setq custom-safe-themes t)
  (use-package eziam-dark-theme
    :ensure eziam-theme
    :init (load-theme 'eziam-dark t)
    :config
    (set-face-background 'default "black")
    (set-face-background 'fringe (face-attribute 'default :background))
    ;; TODO: system-install font
    (set-face-attribute 'default nil :height 105 :font "Hack")
    (setq-default inhibit-x-resources t))
#+END_SRC
* Packages
** company
#+BEGIN_SRC emacs-lisp
  (use-package company
    :diminish ""
    :hook (after-init . global-company-mode))
#+END_SRC
** expand-region
#+BEGIN_SRC emacs-lisp
  (use-package expand-region
    :bind (("C-x x" . er/expand-region)))
#+END_SRC
** git-timemachine
#+BEGIN_SRC emacs-lisp
  (use-package git-timemachine
    :bind (("C-x G" . git-timemachine)))
#+END_SRC
** helm
#+BEGIN_SRC emacs-lisp
  (use-package helm
    :diminish ""
    :commands (helm)
    :bind-keymap ("C-i" . helm-execute-persistent-action)
    :bind (("C-x b" . helm-mini)
           ("C-x C-f" . helm-find-files)
           ("M-x" . helm-M-x)
           ("M-y" . helm-show-kill-ring)
           ("C-M-h" . me/kill-region-or-backward-kill-word)
           ("C-c M-o" . helm-occur)
           ("C-x C-r" . helm-recentf))
    :config
    (helm-mode t)
    (setq helm-buffers-fuzzy-matching t
          helm-recentf-fuzzy-match t
          helm-M-x-fuzzy-match t))
#+END_SRC
*** helm plugins
#+BEGIN_SRC emacs-lisp
  (use-package helm-company)
  (use-package helm-rg
    :bind (("C-x C-p" . helm-projectile-rg)))
  (use-package helm-projectile
    :bind (("C-x C-b" . helm-projectile-switch-to-buffer)))
#+END_SRC
** magit
#+BEGIN_SRC emacs-lisp
  (use-package magit
    :bind (("C-M-g" . magit-status)))
#+END_SRC
** projectile
#+BEGIN_SRC emacs-lisp
  (use-package projectile
    :diminish ""
    :demand t
    :after (helm)
    :hook (after-init . projectile-global-mode)
    :bind-keymap (("C-c C-p" . projectile-command-map))
    :custom (projectile-completion-system 'helm)
    :config
    (setq-default projectile-mode-line " P"))
#+END_SRC
** yasnippet
#+BEGIN_SRC emacs-lisp
  (use-package yasnippet
    :diminish yas-minor-mode
    :hook (after-init . yas-global-mode))
#+END_SRC
